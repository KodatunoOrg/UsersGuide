<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> 
<HTML> 
<HEAD LANG="ja"> 
	<TITLE>Kodatuno User's Guide</TITLE> 
	<meta HTTP-EQUIV="Content-type" CONTENT="text/html; charset=euc-jp"> 
</HEAD> 
<BODY bgcolor="#ffffff"> 
<table cellspacing="0" cellpadding="0" border="0" width="100%">   
	<tr valign="top" height="32">   
	</tr>   
	<tr valign="top">        
		<td width="256" valign="bottom" align="left">          
			<IMG SRC="pixmaps/logo.jpg" width="300" height="98" alt="Kodatuno Logo" ALIGN="top">
		</td>        
		<td valign="bottom" align="center">          
			<center> 	   
		<b><big>Kodatuno User's Guide</big>
		</b>
		<center>        
		</td>       
		<td width="20%" valign="bottom" align="right">          
			<A HREF="./3-1.html" TARGET="_top">Prev</A>     
			<A HREF="./index.html" TARGET="_top">Index</A>          
			<A HREF="./3-3.html" TARGET="_top">Next</A><br>     
		</td>   
	</tr> 
</table> 
<blockquote> 

<BR><HR><H2>NURBS演算ライブラリ</H2>
【NURBS_Func.h】<BR><BR>
NURBS操作モジュールを提供します。<BR>

<BR>■シンボル
<pre><font size="3">
#define PTNUMMAX            10000       NURBSの点列の最大数
#define RANKMAX             9           NURBSの階数の最大値
#define INTERSECPTNUMMAX    1000        交点格納配列長
#define NEAREST_GAP         0.01        2点が同一点とみなす距離
#define CONVERG_GAP         0.00001     ニュートン法の収束を判別する閾値
#define LOOPCOUNTMAX        10000       収束計算回数の条件
#define CONVDIVNUM          10          収束計算用のパラメータ分割数
#define TRM_BORDERDIVNUM    20          トリム境界線上に生成する点の数
#define FORWARD             1           交線追跡の方向(順)
#define INVERSE             0           交線追跡の方向(逆)
#define OUTTER_TRIM         0           外周トリミング領域
#define INNER_TRIM          1           内周トリミング領域
</font></pre>
<HR>
<BR>■インクルードライブラリ<BR><BR>
"BODY.h" "Describe_BODY.h"<BR><BR>
<HR>
<BR>■型定義<BR><BR>
なし<BR><BR>
<HR>
<BR>■クラス<BR><BR>
NURBS_Func<BR>
<継承><BR>
BODY_Handler<BR><BR>
<HR>
<BR>■関数(Class NURBS_Func)<BR><BR>

<A NAME="CalcNurbs*Coord()"> </A>
<H4>public<BR>
Coord CalcNurbsCCoord(NURBSC *NurbsC)  <BR>
Coord CalcNurbsSCoord(NURBSS *NurbsS) <BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>指定したパラメータにおけるNURBS曲線/曲面の座標値を求める。</DD>
<DT> ＜引数＞ </DT>
<DD>*NurbsC / *NurbsS：NURBS曲線/曲面へのポインタ</DD>
<DT> ＜戻り値＞ </DT>
<DD>NURBS曲線/曲面の座標値</DD>
</DL>
<BR><BR>

<A NAME="CalcNurbs*Coords()"> </A>
<H4>public<BR>
void CalcNurbsCCoords(NURBSC *NurbsC,int Ptnum,double *T,Coord *Pt) <BR>
void CalcNurbsSCoords(NURBSS *NurbsS,int Ptnum,Coord *UV,Coord *Pt) <BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>指定したパラメータ群におけるNURBS曲線/曲面の座標値群を求める。</DD>
<DT> ＜引数＞ </DT>
<DD>*NurbsC / *NurbsS：NURBS曲線/曲面へのポインタ <BR>
 Ptnum：求める点群の数  <BR>
 T/UV：NURBS曲線/曲面のパラメータ群  <BR>
 Pt：NURBS曲線/曲面の座標値 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>なし</DD>
</DL>
<BR><BR>

<A NAME="CalcDiff*NurbsS()"> </A>
<H4>public<BR>
Coord CalcDiffuNurbsS(NURBSS *NurbsS,double div_u,double div_v);<BR>
Coord CalcDiffvNurbsS(NURBSS *NurbsS,double div_u,double div_v);<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>指定したパラメータにおけるNURBS曲面のu/v方向の1階微分係数を求める。</DD>
<DT> ＜引数＞ </DT>
<DD>*NurbsS：NURBS曲面へのポインタ  <BR>
 div_u：uパラメータ  <BR>
 div_v：vパラメータ <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>1階微分係数</DD>
</DL>
<BR><BR>

<A NAME="GenNurbs*()"> </A>
<H4>public<BR>
int GenNurbsC(NURBSC *NurbsC,int K,int M,int N,double T[],double W[],Coord cp[],double V[],int prop)<BR>
int GenNurbsC(NURBSC *NurbsC,NURBSC nurb)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>1つのNURBS曲線を生成/コピーする。</DD>
<DT> ＜引数＞ </DT>
<DD>*NurbsC：NURBS曲線へのポインタ  <BR>
 K：コントロールポイントの数  <BR>
 M：階数  <BR>
 N：ノットベクトルの数  <BR>
 T[]：ノットシーケンスの値  <BR>
 W[]：Weightの値  <BR>
 cp[]：コントロールポイントの値  <BR>
 V[]：パラメータの範囲  <BR>
 prop[]：各プロパティの値  <BR>
 euflag：ディレクトリ部 Entity Use Flagの値  <BR>
 *NurbsC：新たに生成するNURBS曲線 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>成功：KOD_TRUE  <BR>
 失敗：KOD_ERR <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GenNurbsS()"> </A>
<H4>public<BR>
int GenNurbsS(NURBSS *NurbsS,int Mu,int Mv,int Ku,int Kv,double *S,double *T,double **W,Coord **Cp,double U_s,double U_e,double V_s,double V_e) <BR>
int NURBS_Func::GenNurbsS(NURBSS *Nurbs,NURBSS nurb)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>1つのNURBS曲面を生成/コピーする。</DD>
<DT> ＜引数＞ </DT>
<DD> *NurbsS：NURBS曲面へのポインタ  <BR>
 Mu：u方向の階数  <BR>
 Mv：v方向の階数  <BR>
 Ku：u方向のコントロールポイントの数  <BR>
 Kv：v方向のコントロールポイントの数  <BR>
 *S：u方向のノットベクトルの値  <BR>
 *T：v方向のノットベクトルの値  <BR>
 **W：Weightの値  <BR>
 **Cp：コントロールポイントの値  <BR>
 U_s：uパラメータの範囲の最初の値  <BR>
 U_e：uパラメータの範囲の最後の値  <BR>
 V_s：vパラメータの範囲の最初の値  <BR>
 V_e：vパラメータの範囲の最後の値  <BR>
 *NurbsS：新たに生成するNURBS曲線  <BR>
 nurb：コピーするNURBS曲面  <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 成功：KOD_TRUE   <BR>
 失敗：KOD_ERR  <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GenRotNurbsS()"> </A>
<H4>public<BR>
int GenRotNurbsS(NURBSS *NurbsS,NURBSC NurbsC,Coord Axis,double deg)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線を原点を通る任意の回転軸回りにある角度だけ回転させ、回転サーフェスを生成する。</DD>
<DT> ＜引数＞ </DT>
<DD>  *NurbsS：生成された回転サーフェス  <BR>
 NurbsC：回転させるNURBS曲線  <BR>
 Axis：任意の回転軸  <BR>
 deg：回転角度 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 成功：KOD_TRUE   <BR>
 失敗：KOD_ERR  <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GenSweepNurbsS()"> </A>
<H4>public<BR>
int GenSweepNurbsS(NURBSS *NurbsS,NURBSC NurbsC,Coord Axis,double Len) <BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線を原点を通る任意の回転軸回りにある角度だけ回転させ、回転サーフェスを生成する。</DD>
<DT> ＜引数＞ </DT>
<DD>   *NurbsS：生成されたスイープサーフェス  <BR>
 NurbsC：スイープさせるNURBS曲線  <BR>
 Axis：任意の軸  <BR>
 Len：移動距離 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 成功：KOD_TRUE   <BR>
 失敗：KOD_ERR  <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GenTrimdNurbsS()"> </A>
<H4>public<BR>
int GenTrimdNurbsS(TRIMD_NURBSS *TNurbs,TRIMD_NURBSS  tnurb) <BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>トリム面を有するNURBS曲面を生成する。</DD>
<DT> ＜引数＞ </DT>
<DD>    *Tnurbs：新たに生成するトリム面  <BR>
 nurb：元となるトリム面 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 成功：KOD_TRUE   <BR>
 失敗：KOD_ERR  <BR>
</DD>
</DL>
<BR><BR>

<A NAME="DelTrimdNurbsS()"> </A>
<H4>public<BR>
int DelTrimdNurbsS(TRIMD_NURBSS *TNurbs)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>GenTrimdNurbsS()によって生成されたトリム面を削除する。</DD>
<DT> ＜引数＞ </DT>
<DD>    *Tnurbs：削除するトリム面  <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 成功：KOD_TRUE   <BR>
 失敗：KOD_ERR  <BR>
</DD>
</DL>
<BR><BR>

<A NAME="DelNurbs*()"> </A>
<H4>public<BR>
void DelNurbsC(NURBSC *NurbsC)<BR>
void DelNurbsS(NURBSS *NurbsS)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>GenNurbsC()/GenNurbsS()によって生成されたNURBS曲線/曲面を削除する。</DD>
<DT> ＜引数＞ </DT>
<DD>   *NurbsC/*NurbsS：削除するNURBS曲線/曲面  <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> なし<BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcBSbasis()"> </A>
<H4>public<BR>
double CalcBSbasis(double t, double knot[],int N,int I,int M)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>GenNurbsC()/GenNurbsS()によって生成されたNURBS曲線/曲面を削除する。</DD>
<DT> ＜引数＞ </DT>
<DD>    t：ノット  <BR>
 knot[]：ノットベクトル  <BR>
 N：ノットベクトルの数  <BR>
 I：Bスプライン基底関数下添え字の1つ目(0〜) <BR>
 M：Bスプライン基底関数下添え字の2つ目(階数)   <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> Bスプライン基底関数の計算結果<BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcDiffBSbasis()"> </A>
<H4>public<BR>
double CalcDiffBSbasis(double t,double knot[],int N,int I,int M)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>Bスプライン基底関数の1階微分係数を求める。</DD>
<DT> ＜引数＞ </DT>
<DD>     t：ノット  <BR>
 knot[]：ノットベクトル  <BR>
 N：ノットベクトルの数  <BR>
 I：注目中のコントロールポイント  <BR>
 M：階数 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> Bスプライン基底関数の1階微分係数の計算結果<BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcDiffBSbasisN()"> </A>
<H4>public<BR>
double CalcDiffBSbasisN(double t,double knot[],int N,int I,int M,int Dn)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>Bスプライン基底関数のN階微分係数を求める。</DD>
<DT> ＜引数＞ </DT>
<DD>  t：ノット  <BR>
 knot[]：ノットベクトル  <BR>
 N：ノットベクトルの数  <BR>
 I：注目中のコントロールポイント <BR> 
 M：階数  <BR>
 Dn：微分階数 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> Bスプライン基底関数のN階微分係数の計算結果<BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcDiffNurbsC()"> </A>
<H4>public<BR>
Coord CalcDiffNurbsC(NURBSC *NurbsC,double t)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線の1階微分係数を求める。</DD>
<DT> ＜引数＞ </DT>
<DD>  *NurbsC：NURBS曲線へのポインタ  <BR>
 t：ノット <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> NURBS曲線の1階微分係数<BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcDiff2NurbsC()"> </A>
<H4>public<BR>
Coord CalcDiff2NurbsC(NURBSC *NurbsC,double t)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線の2階微分係数を求める。</DD>
<DT> ＜引数＞ </DT>
<DD>  *NurbsC：NURBS曲線へのポインタ  <BR>
 t：ノット <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> NURBS曲線の2階微分係数<BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcNormVecOnNurbsS()"> </A>
<H4>public<BR>
Coord CalcNormVecOnNurbsS(NURBSS *nurb,double u,double v)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲面上の(u,v)における方線ベクトルを求める。</DD>
<DT> ＜引数＞ </DT>
<DD>  *nurb：NURBS曲面へのポインタ  <BR>
 u：uパラメータ  <BR>
 ｖ：vパラメータ <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 単位法線ベクトル<BR>
</DD>
</DL>
<BR><BR>

<A NAME="ClacuIntersecPtNurbsLine()"> </A>
<H4>public<BR>
int ClacuIntersecPtNurbsLine(NURBSS *Nurb,Coord r,Coord p,Coord *ans,Coord *param)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲面と直線の交点を算出する。</DD>
<DT> ＜引数＞ </DT>
<DD>  *Nurb：NURBS曲面へのポインタ  <BR>
 r：直線N(t)上の1点  <BR>
 p：直線N(t)の方向  <BR>
 *ans：交点座標  <BR>
 *param：交点のu,v,tパラメータ <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> KOD_ERR：収束しなかった  <BR>
 KOD_TRUE：収束した <BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcIntersecCurve3()"> </A>
<H4>public<BR>
int CalcIntersecCurve3(NURBSC *nurb,Coord pt,Coord nvec,double *ans,int ans_size)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線と平面との交点を求める。</DD>
<DT> ＜引数＞ </DT>
<DD>   *nurb：NURBS曲面へのポインタ   <BR>
 pt：平面上の一点   <BR>
 nvec：平面の法線ベクトル   <BR>
 *ans：算出された交点のtパラメータ値   <BR>
 ans_size：ansの配列長  <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 交点の個数  <BR>
 交点は最大で(M-1)*(K-M+1)点得られる。  
 よって引数*ansは（M-1)*(K-M+1)個の配列を用意することが望ましい。 <BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcIntersecPtsPlaneV3()"> </A>
<H4>public<BR>
int CalcIntersecPtsPlaneV3(NURBSS *nurb,Coord pt,Coord nvec,int v_divnum,Coord *ans,int ans_size)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>3次以下のNURBS曲面と平面との交点群を代数解法にて求める(vパラメータ)。</DD>
<DT> ＜引数＞ </DT>
<DD>    *nurb：NURBS曲面へのポインタ  <BR>
 pt：平面上の一点  <BR>
 nvec：平面の法線ベクトル  <BR>
 v_divnum：vパラメータ分割数  <BR>
 *ans：算出された交点のu,vパラメータ値  <BR>
 ans_size：ansの配列長 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 交点の個数(交点の数がans_sizeを超えた：KOD_ERR) <BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcIntersecPtsPlaneU3()"> </A>
<H4>public<BR>
int CalcIntersecPtsPlaneU3(NURBSS *nurb,Coord pt,Coord nvec,int u_divnum,Coord *ans,int ans_size)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>3次以下のNURBS曲面と平面との交点群を代数解法にて求める(vパラメータ)。</DD>
<DT> ＜引数＞ </DT>
<DD>     *nurb：NURBS曲面へのポインタ  <BR>
 pt：平面上の一点  <BR>
 nvec：平面の法線ベクトル  <BR>
 u_divnum：uパラメータ分割数  <BR>
 *ans：算出された交点のu,vパラメータ値  <BR>
 ans_size：ansの配列長 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 交点の個数(交点の数がans_sizeを超えた：KOD_ERR) <BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcIntersecPtsPlaneSearch3()"> </A>
<H4>public<BR>
int CalcIntersecPtsPlaneSearch3(NURBSS *nurb,Coord pt,Coord nvec,double ds,int initdivnum,Coord *ans,int ans_size)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲面と平面との交点群を交線追跡法にて求める。</DD>
<DT> ＜引数＞ </DT>
<DD> *nurb：NURBS曲面へのポインタ  <BR>
 pt：平面上の一点  <BR>
 nvec：平面の法線ベクトル  <BR>
 ds：交線(交点群)の粗さ(密0.1〜2疎)  <BR>
 *ans：算出された交点のu,vパラメータ値  <BR>
 ans_size：ansの配列長 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 交点の個数(NURBS曲面と平面が交差していない：KOD_FALSE、交点の数がans_sizeを超えた：KOD_ERR)<BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcIntersecPtsNurbsSGeom()"> </A>
<H4>public<BR>
int CalcIntersecPtsNurbsSGeom(NURBSS *nurbR,NURBSS *nurbS,int u_divnum,int v_divnum,Coord *ansR,Coord *ansS,int ans_size)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲面S(u,v)とNURBS曲面R(w,t)の交線(交点群)を幾何学的にて求める(補助平面を用いた解法）</DD>
<DT> ＜引数＞ </DT>
<DD>  *nurbR：NURBS曲面R(w,t)へのポインタ  <BR>
 *nurbS：NURBS曲面S(u,v)へのポインタ  <BR>
 u_divnum：uパラメータの分割数  <BR>
 v_divnum：vパラメータの分割数  <BR>
 *ansR：算出された交点のw,tパラメータ値  <BR>
 *ansS：算出された交点のu,vパラメータ値  <BR>
 ans_size：ansの配列長 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>交点の個数(交点の数がans_sizeを超えた：KOD_ERR) <BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcIntersecPtsNurbsSSearch()"> </A>
<H4>public<BR>
int CalcIntersecPtsNurbsSSearch(NURBSS *nurbR,NURBSS *nurbS,int div,double ds,Coord *ansR,Coord *ansS,int ans_size)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲面S(u,v)とNURBS曲面R(w,t)の交線(交点群)を交点追跡法にて求める。</DD>
<DT> ＜引数＞ </DT>
<DD>  *nurbR：NURBS曲面R(w,t)へのポインタ  <BR>
 *nurbS：NURBS曲面S(u,v)へのポインタ  <BR>
 div：パラメータの分割数  <BR>
 ds：交線(交点群)の粗さ(密0.1〜2疎)  <BR>
 *ansR：算出された交点のw,tパラメータ値  <BR>
 *ansS：算出された交点のu,vパラメータ値  <BR>
 ans_size：ansの配列長 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>NURBS曲面同士が交差していない：KOD_FALSE  特異点または発散により処理を中断：KOD_ERR <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GetBSplCoef*()"> </A>
<H4>public<BR>
int GetBSplCoef3(int, int, int, double *, double **)<BR>
int GetBSplCoef2(int, int, int, double *, double **)<BR>
int GetBSplCoef1(int, int, int, double *, double **)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>3/2/1次のBスプライン曲線の各係数を求める。</DD>
<DT> ＜引数＞ </DT>
<DD> M：階数  
 K：コントロールポイントの数  <BR>
 i：注目中のコントロールポイント<BR>  
 *t：ノットベクトル列  <BR>
 *coef：算出される係数 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>正常終了：KOD_TRUE<BR>
</DD>
</DL>
<BR><BR>

<A NAME="ShiftNurbs*()"> </A>
<H4>public<BR>
void ShiftNurbsC(NURBSC *nurbs,Coord shift)<BR>
void ShiftNurbsS(NURBSS *nurbs,Coord shift)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線/曲面をシフトする。</DD>
<DT> ＜引数＞ </DT>
<DD>  *NurbsC/*NurbsS：シフトされるNURBS曲線/曲面 <BR>
 shift：シフト量 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>なし<BR>
</DD>
</DL>
<BR><BR>

<A NAME="ShiftNurChRatioNurbsbs*()"> </A>
<H4>public<BR>
void ChRatioNurbsC(NURBSC *NurbsC,Coord ratio)<BR>
void ChRatioNurbsS(NURBSS *NurbsS,Coord ratio)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線/曲面の倍率を変更する。</DD>
<DT> ＜引数＞ </DT>
<DD>  *NurbsC/*NurbsS：変更されるNURBS曲線/曲面 <BR>
 ratio：倍率<BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>なし<BR>
</DD>
</DL>
<BR><BR>

<A NAME="SetCPNurbsS()"> </A>
<H4>public<BR>
int SetCPNurbsS(NURBSS *nurbs,NURBSS Nurbs)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲面間にコントロールポイントを代入する。</DD>
<DT> ＜引数＞ </DT>
<DD>   *nurbs：代入されるNURBS曲面 <BR> 
 Nurbs：代入元のNURBS曲面 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>成功：KOD_TRUE <BR> 
 失敗：KOD_ERR <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GenInterpolatedNurbsC1()"> </A>
<H4>public<BR>
int GenInterpolatedNurbsC1(NURBSC *Nurbs,Coord *P,int PNum,int N)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>与えられた点列を補間する最高4階のNURBS曲線を生成する(端末条件を与えない)。</DD>
<DT> ＜引数＞ </DT>
<DD>  *Nurbs：生成されるNURBS曲線<BR>  
 *P：点列  <BR>
 PNum：点列の数 <BR> 
 M：階数 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>成功：KOD_TRUE <BR> 
 失敗：KOD_ERR <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GenInterpolatedNurbsC2()"> </A>
<H4>public<BR>
int GenInterpolatedNurbsC2(NURBSC *Nurbs,Coord *P_,int PNum,int N)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>与えられた点列を補間する最高4階のNURBS曲線を生成する(端末条件：始点とC2で一致)。</DD>
<DT> ＜引数＞ </DT>
<DD> *Nurbs：生成されるNURBS曲線  <BR>
 *P_：通過点列  <BR>
 PNum：通過点列の数 <BR>
 M：階数 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 正常終了：KOD_TRUE  <BR>
 始点と終点の不一致：KOD_FALSE  <BR>
 点列の数が1個未満：KOD_ERR <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GenApproximationNurbsC()"> </A>
<H4>public<BR>
int GenApproximationNurbsC(NURBSC *Nurbs,Coord *P,int PNum,int M)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>与えられた点列を近似するn階のNURBS曲線を生成する。</DD>
<DT> ＜引数＞ </DT>
<DD>  *Nurbs：生成されるNURBS曲線  <BR>
 *P：点列  <BR>
 Pnum：点列の数  <BR>
 M：階数 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>  成功：KOD_TRUE<BR>  
 失敗：KOD_ERR <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GenPolygonalLine()"> </A>
<H4>public<BR>
int GenPolygonalLine(NURBSC *Nurbs,Coord *P,int PNum)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>折れ線を生成する。</DD>
<DT> ＜引数＞ </DT>
<DD>  *Nurbs：生成されるNURBS曲線<BR>  
 *P：コントロールポイント  <BR>
 PNum：コントロールポイントの数 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>  成功：KOD_TRUE<BR>  
 失敗：KOD_ERR <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GenInterpolatedNurbsS1()"> </A>
<H4>public<BR>
int GenInterpolatedNurbsS1(NURBSS *Nurbs,Coord **P,int PNum_u,int PNum_v,int Mu,int Mv)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>与えられた点列を補間する最高4階のNURBS曲面を生成する。</DD>
<DT> ＜引数＞ </DT>
<DD>  *Nurbs：生成されるNURBS曲面  <BR>
 **P：与えられた点列  <BR>
 PNum_u/PNum_v：点の数  <BR>
 Mu/Mv：階数 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>  成功：KOD_TRUE<BR>  
 失敗：KOD_ERR <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GenPolygonalSurface()"> </A>
<H4>public<BR>
int GenPolygonalSurface(NURBSS *Nurbs,Coord **P,int PNum_u,int PNum_v)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>折れ面を生成する。</DD>
<DT> ＜引数＞ </DT>
<DD>  *Nurbs：生成されるNURBS曲面<BR>  
 **P：コントロールポイント  <BR>
 PNum_u/PNum_v：コントロールポイントの数 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>  成功：KOD_TRUE<BR>  
 失敗：KOD_ERR <BR>
</DD>
</DL>
<BR><BR>

<A NAME="DetermPtOnTRMSurf()"> </A>
<H4>public<BR>
int DetermPtOnTRMSurf(TRMS *Trim,double u,double v)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>注目中のNURBS曲面上の1点(u,v)がトリミング領域内にあるのかを判定する。</DD>
<DT> ＜引数＞ </DT>
<DD>  *Trim：トリム曲面へのポインタ <BR> 
 u：注目中のuパラメータ  <BR>
 ｖ：注目中のｖパラメータ <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>   面上(エッジ上含む)：KOD_TRUE  <BR>
 面外：KOD_FALSE  <BR>
 エラー：KOD_ERR  <BR>
</DD>
</DL>
<BR><BR>

<A NAME="RotNurbs*()"> </A>
<H4>public<BR>
void RotNurbsC(NURBSC *nurbs,Coord axis,double deg)<BR>
void RotNurbsS(NURBSS *nurbs,Coord axis,double deg)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線/曲面をDベクトル回りにdeg(°)だけ回転させる。</DD>
<DT> ＜引数＞ </DT>
<DD> *nurbs：回転させるNURBS曲線/曲面  <BR>
 axis：回転軸の単位ベクトル<BR>  
 deg：角度(degree) <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> なし<BR>
</DD>
</DL>
<BR><BR>

<A NAME="DetectInterfere*S()"> </A>
<H4>public<BR>
int DetectInterfereNurbsS(NURBSS *nurbR,NURBSS *nurbS,int divnum)<BR>
int DetectInterfereTrmS(TRIMD_NURBSS *tNurbR,TRIMD_NURBSS *tNurbS,int divnum)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS/トリム曲面S(u,v)とNURBS/トリム曲面R(w,t)の干渉を検出する。</DD>
<DT> ＜引数＞ </DT>
<DD>  *nurbsR/tNurbsR：NURBS/トリム曲面R(w,t)  <BR>
 *nurbsS/tNurbsS：NURBS/トリム曲面S(u,v)  <BR>
 divnum：パラメータ分割数 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD> 干渉の有無(干渉あり：TRUE　干渉無し：FALSE)<BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcNurbsCLength()"> </A>
<H4>public<BR>
double CalcNurbsCLength(NURBSC *Nurb)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線の線分長を微小線分近似により求める。</DD>
<DT> ＜引数＞ </DT>
<DD> *Nurb：対象となるNURBS曲線<BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>線分長<BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcDeltaPtsOnNurbsC()"> </A>
<H4>public<BR>
int CalcDeltaPtsOnNurbsC(NURBSC *Nurb,double D,Coord *Pts)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>指定した間隔でNURBS曲線上の座標値を出力する。</DD>
<DT> ＜引数＞ </DT>
<DD> *Nurb：対象となるNURBS曲線  <BR>
 D：間隔  <BR>
 *Pts：出力される座標値を格納 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>点数<BR>
</DD>
</DL>
<BR><BR>

<A NAME="GetNurbsCCoef()"> </A>
<H4>private<BR>
int GetNurbsCCoef(NURBSC *nurb,double **coef,int i,Coord *P,double *Q)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線の係数を求める(最高3次)。</DD>
<DT> ＜引数＞ </DT>
<DD>  *nurb：対象となるNURBS曲線  <BR>
 coef：Bスプライン基底関数の係数  <BR>
 i：曲線の番号  <BR>
 *P/*Q：NURBS曲線の係数(P,Q) <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>成功：KOD_TRUE <BR> 
 失敗：KOD_ERR <BR>
</DD>
</DL>
<BR><BR>

<A NAME="CalcEquation()"> </A>
<H4>private<BR>
int CalcEquation(double *a,double *t,int M)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>3次方程式まで解く。</DD>
<DT> ＜引数＞ </DT>
<DD>  *a：係数<BR>  
 *t：解  <BR>
 M：次数  <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>成功：KOD_TRUE <BR> 
 失敗：KOD_ERR <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GetNurbsSCoef()"> </A>
<H4>private<BR>
void GetNurbsSCoef(int M,double **coef,double *a,Coord *b,int i,Coord *P,double *Q)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線C(u) or C(v)の係数を求める。</DD>
<DT> ＜引数＞ </DT>
<DD>  M：階数  <BR>
 coef：Bスプライン基底関数の係数  <BR>
 *a/*b：u/vを固定した時のNURBS曲線C(v)/C(u)の分母/分子の係数 <BR>
 i：曲線の番号  <BR>
 *P/*Q：固定されたパラメータにおけるNURBS曲面の係数(P,Q) <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>なし <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GetIntersecEquation()"> </A>
<H4>private<BR>
void GetIntersecEquation(int M,Coord *P,double *Q,Coord pt,Coord nvec,double *a)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>NURBS曲線と平面の交線導出用方程式を得る。</DD>
<DT> ＜引数＞ </DT>
<DD> M：階数  <BR>
 *P/*Q：NURBS曲線の係数（P,Q)  <BR>
 pt：平面上の一点  <BR>
 nvec：平面の法線ベクトル  <BR>
 *a：結果  <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>なし <BR>
</DD>
</DL>
<BR><BR>

<A NAME="SearchIntersectPt()"> </A>
<H4>private<BR>
int SearchIntersectPt(NURBSS *nurb,Coord pt,Coord nvec,double ds,double *u,double *v,int direction)<BR>
int SearchIntersectPt_RKM(NURBSS *S,Coord pt,Coord n,double delta,double *u,double *v,int direction)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>ニュートン法により交点を真値に収束させる</DD>
<DT> ＜引数＞ </DT>
<DD> *nurb/nurbR：1つ目の対象となるNURBS曲面 <BR>
 pt,nvec/nurbS：2つ目の対象となる平面/NURBS曲面 <BR>
 ds：粗さ  <BR>
 *u,*v,*w,*t：パラメータ  <BR>
 direction：追跡方向を表すフラグ <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>収束した場合：KOD_TRUE  <BR>
 パラメータ範囲外：KOD_FALSE  <BR>
 失敗：KOD_ERR  <BR>
</DD>
</DL>
<BR><BR>

<A NAME="DetermPtOnTRMSurf_sub()"> </A>
<H4>private<BR>
int DetermPtOnTRMSurf_sub(CONPS *Conps,double u,double v)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>面上線のタイプが複合曲線の場合のトリミング領域内外判定</DD>
<DT> ＜引数＞ </DT>
<DD>  *Conps：面上線へのポインタ <BR> 
 u/v：パラメータ <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>内外判定(失敗：KOD_ERR) <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GetKnot()"> </A>
<H4>private<BR>
void GetKnot(Vector T_,int N,int K,int M,Vector T)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>面上線のタイプが複合曲線の場合のトリミング領域内外判定</DD>
<DT> ＜引数＞ </DT>
<DD>  T_：曲線パラメータ列  <BR>
 N：ノットベクトルの数  <BR>
 M：階数  <BR>
 T：格納するノットベクトル列  <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>なし <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GetKnotParam1()"> </A>
<H4>private<BR>
void GetKnotParam1(Coord *P,int PNum,Vector T_)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>各通過点の曲線パラメータを算出(コード長の比から算出)</DD>
<DT> ＜引数＞ </DT>
<DD> *P：通過点列  <BR>
 PNum：通過点列の数  <BR>
 T_：曲線パラメータを格納 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>なし <BR>
</DD>
</DL>
<BR><BR>

<A NAME="GetKnotParam2()"> </A>
<H4>private<BR>
void GetKnotParam2(Coord *P,int PNum,Vector T_)<BR></H4>
<DL>
<DT> ＜説明＞ </DT>
<DD>各通過点の曲線パラメータを算出(コード長の平方根の比から算出)</DD>
<DT> ＜引数＞ </DT>
<DD> *P：通過点列  <BR>
 PNum：通過点列の数  <BR>
 T_：曲線パラメータを格納 <BR>
</DD>
<DT> ＜戻り値＞ </DT>
<DD>なし <BR>
</DD>
</DL>
<BR><BR>

</blockquote> <HR> Document Release 1.0 for Kodatuno R1.1, Mar. 2011<P> <hr> <center>
<A HREF="./3-1.html" TARGET="_top">Prev</A>
<A HREF="./index.html" TARGET="_top">index</A>
<A HREF="./3-3.html" TARGET="_top">Next</A><br>
</center> <hr> <table cellpadding="0" cellspacing="0" border="0" width="100%">    
<tr>      
	<td align="left">        
		<small>Copyright(C) Kodatuno Development Team, 2011</small>      
	</td>      
	<td align="right">        
		<small><i>Last modified: Mar. 3, 2011</i></small>      
	</td>   
</tr> </table>  <!-- end of body --> </body>  
</html>  



